calc.relip.mm(npred_lmer)
npred_soil_lmer = lmer(narea ~ nphoto + nstructure + nstructure:Nfix + Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_plot = ggplot(data = leaf,
aes(x = nall, y = narea, color = Ntrt_fac)) +
theme(legend.position = "right",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point()
npred_plot
calc.relip.mm(npred_soil_lmer)
npred_soil_lmer = lmer(log(narea) ~ log(nphoto) + log(nstructure) +
log(nstructure):Nfix + Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
hist(leaf$nphoto)
hist(leaf$vcmax25)
subset(leaf, vcmax25 < 0)
subset(gas_exchange_pred, vcmax < 0)
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
#####################################################################
## Narea predictions
#####################################################################
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf$tmp,
paro = leaf$par,
cao = 400,
vpdo = leaf$vpd,
z = leaf$z,
chi = leaf$chi)
subset(gas_exchange_pred, vcmax < 0)
leaf$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf$nrubisco = fvcmax25_nrubisco(leaf$vcmax25)
leaf$nbioe = fjmax25_nbioe(leaf$jmax25)
leaf$nstructure = flma_nstructure(leaf$lma)
leaf$nall = leaf$nrubisco + leaf$nbioe + leaf$nstructure
leaf$nphoto = leaf$nrubisco + leaf$nbioe
leaf$nrubisco_frac = leaf$nrubisco / leaf$nall
leaf$nphoto_frac = leaf$nphoto / leaf$nall
npred_lmer = lmer(narea ~ nphoto + nstructure + nstructure:Nfix +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
Anova(npred_lmer)
summary(npred_lmer)
calc.relip.mm(npred_lmer)
npred_soil_lmer = lmer(log(narea) ~ log(nphoto) + log(nstructure) +
log(nstructure):Nfix + Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_soil_lmer = lmer(narea ~ nphoto + nstructure +
nstructure:Nfix + Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_plot = ggplot(data = leaf,
aes(x = nall, y = narea, color = Ntrt_fac)) +
theme(legend.position = "right",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point()
npred_plot
plot(resid(npred_soil_lmer) ~ fitted(npred_soil_lmer))
npred_soil_lmer = lmer(log(narea) ~ nphoto + nstructure +
nstructure:Nfix + Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
plot(resid(npred_soil_lmer) ~ fitted(npred_soil_lmer))
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_soil_lmer = lmer(log(narea) ~ nphoto + nstructure +
Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
plot(resid(npred_soil_lmer) ~ fitted(npred_soil_lmer))
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_lmer = lmer(log(narea) ~ nphoto + nstructure +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
Anova(npred_lmer)
summary(npred_lmer)
calc.relip.mm(npred_lmer)
npred_soil_lmer = lmer(log(narea) ~ nphoto + nstructure +
Ntrt_fac +
(1|site_code) + (1|site_code:block_fac),
data = leaf)
plot(resid(npred_soil_lmer) ~ fitted(npred_soil_lmer))
Anova(npred_soil_lmer)
summary(npred_soil_lmer)
calc.relip.mm(npred_soil_lmer)
npred_plot = ggplot(data = leaf,
aes(x = nall, y = narea, color = Ntrt_fac)) +
theme(legend.position = "right",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point()
npred_plot
summary(npred_soil_lmer)
leaf_site = read.csv('../Data/processed/traits_site.csv')
leaf_site$Ntrt_fac = as.factor(leaf_site$Ntrt)
leaf_site$Ptrt_fac = as.factor(leaf_site$Ptrt)
leaf_site$Ktrt_fac = as.factor(leaf_site$Ktrt)
leaf_site$block_fac = as.factor(leaf_site$block)
# hist(leaf_site_Nonly$lai_mean)
# hist(log(leaf_site_Nonly$lai_mean))
lai_lmer = lmer(log(lai_mean) ~ Ntrt_fac +
(1|site_code) + (1|site_code:block),
data = leaf_site)
# plot(resid(lai_lmer) ~ fitted(lai_lmer))
Anova(lai_lmer)
cld(emmeans(lai_lmer, ~Ntrt_fac))
(exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[1,2])) /
abs(exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[1,2]))
# hist(leaf_site_Nonly$live_mass_mean)
# hist(log(leaf_site_Nonly$live_mass_mean))
live_mass_lmer = lmer(log(live_mass_mean) ~ Ntrt_fac +
(1|site_code) + (1|site_code:block),
data = leaf_site)
# plot(resid(live_mass_lmer) ~ fitted(live_mass_lmer))
Anova(live_mass_lmer)
cld(emmeans(live_mass_lmer, ~Ntrt_fac))
(exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[1,2])) /
abs(exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[1,2]))
lai_plot = ggplot(data = leaf_site,
aes(x = Ntrt_fac, y = log(lai_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.1, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('') +
ylab(expression('Log LAI (m' ^ '2' *' m' ^'-2' * ')')) +
annotate("text", x = 1.5, y = 1.3, label = "p < 0.05", size = 8)
live_mass_plot = ggplot(data = leaf_site,
aes(x = Ntrt_fac, y = log(live_mass_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.07, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('Nitrogen treatment') +
ylab(expression('Log Biomass (g m' ^ '2' * ')')) +
annotate("text", x = 1.5, y = 7.3, label = "p < 0.01", size = 8)
jpeg(filename = "plots/plant_plot.jpeg", width = 550, height = 900, units = 'px')
multiplot(lai_plot, live_mass_plot, cols=1)
dev.off()
lai_plot = ggplot(data = leaf_site,
aes(x = Ntrt_fac, y = log(lai_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.1, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('') +
ylab(expression('Log LAI (m' ^ '2' *' m' ^'-2' * ')'))
live_mass_plot = ggplot(data = leaf_site,
aes(x = Ntrt_fac, y = log(live_mass_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.07, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('Nitrogen treatment') +
ylab(expression('Log Biomass (g m' ^ '2' * ')'))
jpeg(filename = "plots/plant_plot.jpeg", width = 550, height = 900, units = 'px')
multiplot(lai_plot, live_mass_plot, cols=1)
dev.off()
### non-delta response
narea_supdem_lmer = lmer(log(narea_mean) ~ Ntrt_fac + Ntrt_fac:lai_mean +
(1|site_code) + (1|site_code:block),
data = leaf_site)
plot(resid(narea_supdem_lmer) ~ fitted(narea_supdem_lmer))
Anova(narea_supdem_lmer)
emtrends(narea_supdem_lmer, ~Ntrt_fac, var = 'lai_mean')
test(emtrends(narea_supdem_lmer, ~Ntrt_fac, var = 'lai_mean'))
cld(emtrends(narea_supdem_lmer, ~Ntrt_fac, var = 'lai_mean'))
test(emtrends(narea_supdem_lmer, ~Ntrt_fac, var = 'lai_mean'))
leaf_site_lowN = subset(leaf_site, Ntrt_fac == '0')
leaf_site_highN = subset(leaf_site, Ntrt_fac == '1')
nrow(leaf_site_lowN)
nrow(leaf_site_highN)
leaf_site_trt = left_join(leaf_site_lowN, leaf_site_highN,
by = c('site_code', 'block'))
nrow(leaf_site_trt)
leaf_site_trt
leaf_site_trt = left_join(leaf_site_lowN, leaf_site_highN,
by = c('site_code', 'plot', 'block'))
nrow(leaf_site_trt)
nrow(leaf_site_lowN)
nrow(leaf_site_highN)
nrow(leaf_site_lowN)
nrow(leaf_site_highN)
leaf_site_trt = right_join(leaf_site_lowN, leaf_site_highN,
by = c('site_code', 'plot', 'block'))
nrow(leaf_site_trt)
### calculate deltas (per block per site)
leaf_site_N = group_by(leaf_site, Ntrt_fac)
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf_site, Ntrt_fac)
leaf_site_N = summarise_all(leaf_site_N, .funs = mean(., na.rm = T))
leaf_site_N = summarise_all(leaf_site_N, funs(n(), mean))
leaf_site_N
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf, site_code, Ntrt_fac)
leaf_site_N = summarise(leaf_site_N, narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf, site_code, Ntrt_fac)
colnames(leaf_site_N_group_by)
leaf_site_N = summarise(leaf_site_N_group_by, narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_lowN = subset(leaf_site_N, Ntrt_fac == '0')
leaf_site_highN = subset(leaf_site_N, Ntrt_fac == '1')
leaf_site_N
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf, site_code, Ntrt_fac)
leaf_site_N_group_by
leaf_site_N = summarise(leaf_site_N_group_by, narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_N
head(leaf)
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf,
site_code)
leaf_site_N = summarise(leaf_site_N_group_by,
narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_N
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf,
Ntrt_fac)
leaf_site_N = summarise(leaf_site_N_group_by,
narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_N
summarise(leaf_site_N_group_by,
narea_mean = mean(narea, na.rm = T))
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf,
site_code, Ntrt_fac)
leaf_site_N_group_by
leaf_site_N = summarise(leaf_site_N_group_by,
narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_N
# Script using least-cost to explore Narea response at nutnet
## generally follows the analysis structure of Dong et al. (2017) Biogeosciences
## but includes the addition of soil N as a predictor
#####################################################################
## load packages
#####################################################################
library(tidyverse)
library(lme4)
library(car)
library(r2glmm)
library(treemapify)
library(emmeans)
library(relaimpo)
#####################################################################
## load functions
#####################################################################
source('optimal_vcmax_R/calc_optimal_vcmax.R')
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
sourceDirectory('optimal_vcmax_R/functions')
source('n_from_gas_exchange/n_from_gas_exchange.R')
multiplot <- function(..., plotlist=NULL, cols) {
require(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# Make the panel
plotCols = cols                          # Number of columns of plots
plotRows = ceiling(numPlots/plotCols) # Number of rows needed, calculated from # of cols
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(plotRows, plotCols)))
vplayout <- function(x, y)
viewport(layout.pos.row = x, layout.pos.col = y)
# Make each plot, in the correct location
for (i in 1:numPlots) {
curRow = ceiling(i/plotCols)
curCol = (i-1) %% plotCols + 1
print(plots[[i]], vp = vplayout(curRow, curCol ))
}
}
calc_vcmax_tresp_mult = function(tleaf, tmean, tref){
temp = tleaf + 273.15
Ha= 71513
Hd= 200000
adelS= 668.39
bdelS= -1.07
tmeanK=tmean+273.15
trefK=tref+273.15
R=8.314
kbeg=exp(Ha*(temp-trefK)/(trefK*R*temp))
kend=((1+exp((trefK*(adelS+bdelS*tmean)-Hd)/(trefK*R)))/(1+exp((temp*(adelS+bdelS*tmean)-Hd)/(temp*R))))
kbeg*kend
}
calc_jmax_tresp_mult = function(tleaf, tmean, tref){
temp = tleaf + 273.15
Ha= 49884
Hd= 200000
adelS= 659.7
bdelS= -0.75
tmeanK=tmean+273.15
trefK=tref+273.15
R=8.314
kbeg=exp(Ha*(temp-trefK)/(trefK*R*temp))
kend=((1+exp((trefK*(adelS+bdelS*tmean)-Hd)/(trefK*R)))/(1+exp((temp*(adelS+bdelS*tmean)-Hd)/(temp*R))))
kbeg*kend
}
# relative importance for mixed models from https://gist.github.com/BERENZ/e9b581a4b7160357934e
calc.relip.mm <- function(model,type='lmg') {
if (!isLMM(model) & !isGLMM(model)) {
stop('Currently supports only lmer/glmer objects', call. = FALSE)
}
require(lme4)
X <- getME(model,'X')
X <- X[,-1]
Y <- getME(model,'y')
s_resid <- sigma(model)
s_effect <- getME(model,'theta')*s_resid
s2 <- sum(s_resid^2,s_effect^2)
V <- Diagonal(x = s2,n=nrow(X))
YX <- cbind(Y,X)
cov_XY <- solve( t(YX) %*% solve(V) %*% as.matrix(YX))
colnames(cov_XY) <- rownames(cov_XY) <- colnames(YX)
importances <- calc.relimp(as.matrix(cov_XY),rela=F,type=type)
return(importances)
}
leaf = read.csv('../Data/processed/traits.csv')
leaf$Ntrt_fac = as.factor(leaf$Ntrt)
leaf$Ptrt_fac = as.factor(leaf$Ptrt)
leaf$Ktrt_fac = as.factor(leaf$Ktrt)
leaf$block_fac = as.factor(leaf$block)
leaf$tmp_scaled = leaf$tmp - 25
# leaf_Nonly = subset(leaf, Ptrt_fac == '0' & Ktrt_fac == '0')
leaf_site = read.csv('../Data/processed/traits_site.csv')
leaf_site$Ntrt_fac = as.factor(leaf_site$Ntrt)
leaf_site$Ptrt_fac = as.factor(leaf_site$Ptrt)
leaf_site$Ktrt_fac = as.factor(leaf_site$Ktrt)
leaf_site$block_fac = as.factor(leaf_site$block)
# leaf_site_Nonly = subset(leaf_site, Ptrt_fac == '0' & Ktrt_fac == '0')
### calculate deltas (per block per site)
leaf_site_N_group_by = group_by(leaf,
site_code, Ntrt_fac)
leaf_site_N = summarise(leaf_site_N_group_by,
narea_mean = mean(narea, na.rm = T),
lai_mean = mean(lai, na.rm = T),
chi_mean = mean(chi, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
leaf_site_N
leaf_site_lowN = subset(leaf_site_N, Ntrt_fac == '0')
leaf_site_highN = subset(leaf_site_N, Ntrt_fac == '1')
nrow(leaf_site_lowN)
nrow(leaf_site_highN)
leaf_site_trt = right_join(leaf_site_lowN, leaf_site_highN,
by = c('site_code'))
nrow(leaf_site_trt)
leaf_site_trt$delta_narea = ((leaf_site_trt$narea_mean.y -
leaf_site_trt$narea_mean.x) / leaf_site_trt$narea_mean.x) * 100
leaf_site_trt$delta_lai = ((leaf_site_trt$lai_mean.y -
leaf_site_trt$lai_mean.x) / leaf_site_trt$lai_mean.x) * 100
leaf_site_trt$delta_live_mass = ((leaf_site_trt$live_mass_mean.y -
leaf_site_trt$live_mass_mean.x) / leaf_site_trt$live_mass_mean.x) * 100
leaf_site_trt$delta_chi = ((leaf_site_trt$chi_mean.y -
leaf_site_trt$chi_mean.x) / leaf_site_trt$chi_mean.x) * 100
hist(leaf_site_trt$delta_narea)
### model response
delta_lmer = lmer(delta_narea ~ delta_live_mass +
(1|site_code),
data = leaf_site_trt)
### model response
delta_lmer = lmer(delta_narea ~ delta_lai +
(1|site_code),
data = leaf_site_trt)
leaf_site_trt$delta_lai
hist(leaf_site_trt$delta_lai)
### model response
delta_lm = lm(delta_narea ~ delta_lai,
data = leaf_site_trt)
plot(resid(delta_lm) ~ fitted(delta_lm))
Anova(delta_lm)
summary(delta_lm)
delta_live_mass_lm = lm(delta_narea ~ delta_live_mass,
data = leaf_site_trt)
plot(resid(delta_live_mass_lm) ~ fitted(delta_live_mass_lm))
Anova(delta_live_mass_lm)
summary(delta_live_mass_lm)
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
geom_point()
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point()
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(size = 4, alpha = 0.8)
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(size = 4, alpha = 0.8) +
geom_smooth(delta_lai_lm)
### model response
delta_lai_lm = lm(delta_narea ~ delta_lai,
data = leaf_site_trt)
plot(resid(delta_lai_lm) ~ fitted(delta_lai_lm))
Anova(delta_lai_lm)
summary(delta_lai_lm)
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(size = 4, alpha = 0.8) +
geom_smooth(delta_lai_lm)
ggplot(data = leaf_site_trt,
aes(x = delta_lai, y = delta_narea)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(size = 4, alpha = 0.8) +
geom_smooth(method='lm')
leaf_site_trt$lai_mean.y
leaf_site_trt$lai_mean.x
Anova(delta_lai_lm)
leaf_site_trt
