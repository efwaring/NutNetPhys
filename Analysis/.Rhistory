theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(aes(shape = Ntrt_fac), size = 4) +
scale_color_manual(values = c('grey', 'black')) +
ylab(expression('Log leaf nitrogen (g m'^'-2' * ')')) +
xlab(expression('Log leaf nitrogen (g m'^'-2' * ')'))
narea_chi_plot
narea_chi_plot = ggplot(data = subset(traits_sub_site, Ptrt_fac == '0' & Ktrt_fac == '0'),
aes(x = (chi_mean), y = log(narea_mean), colour = Ntrt_fac)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(aes(shape = Ntrt_fac), size = 4) +
scale_color_manual(values = c('grey', 'black')) +
ylab(expression('Log leaf nitrogen (g m'^'-2' * ')')) +
xlab(expression('Log leaf nitrogen (g m'^'-2' * ')'))
narea_chi_plot
narea_chi_plot = ggplot(data = subset(traits_sub_site, Ptrt_fac == '0' & Ktrt_fac == '0'),
aes(x = (chi_mean), y = log(narea_mean), colour = Ntrt_fac)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(aes(shape = Ntrt_fac), size = 4) +
scale_color_manual(values = c('grey', 'black')) +
ylab(expression('Log leaf nitrogen (g m'^'-2' * ')')) +
xlab(expression('C'[i] * 'C'[a]))
narea_chi_plot
narea_chi_plot = ggplot(data = subset(traits_sub_site, Ptrt_fac == '0' & Ktrt_fac == '0'),
aes(x = (chi_mean), y = log(narea_mean), colour = Ntrt_fac)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_point(aes(shape = Ntrt_fac), size = 4) +
scale_color_manual(values = c('grey', 'black')) +
ylab(expression('Log leaf nitrogen (g m'^'-2' * ')')) +
xlab(expression('C'[i] * '/C'[a]))
narea_chi_plot
chi_trt_lm = lm(log(chi_mean) ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + p_pet_mean +
tmp_mean, data = traits_sub_site)
anova(chi_trt_lm)
emmeans(chi_trt_lm, ~Ntrt_fac)
chi_trt_lm = lm((chi_mean) ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + p_pet_mean +
tmp_mean, data = traits_sub_site)
anova(chi_trt_lm)
emmeans(chi_trt_lm, ~Ntrt_fac)
plot(resid(chi_trt_lm) ~ fitted(chi_trt_lm))
narea_trt_lm = lm(log(narea_mean) ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + p_pet_mean +
tmp_mean, data = traits_sub_site)
anova(narea_trt_lm)
emmeans(narea_trt_lm, ~Ntrt_fac)
###########
lai_trt_lm = lm(log(lai_mean) ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + p_pet_mean +
tmp_mean, data = traits_sub_site)
anova(lai_trt_lm)
emmeans(lai_trt_lm, ~Ntrt_fac)
(0.1244169 + -0.2164028) / 0.2164028
(0.1244169 + 0.2164028) / 0.2164028
(exp(summary(emmeans(lai_trt_lm, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(lai_trt_lm, ~Ntrt_fac))[1,2])) /exp(summary(emmeans(lai_trt_lm, ~Ntrt_fac))[1,2])
narea_trt_lm = lm(log(narea_mean) ~ Ntrt_fac * Ptrt_fac * Ktrt_fac + p_pet_mean +
tmp_mean, data = traits_sub_site)
anova(narea_trt_lm)
library(lme4)
library(car)
library(emmeans)
library(dplyr)
library(plyr)
library(RColorBrewer)
library(multcompView)
library(ggplot2)
leaf = read.csv('../Data/NutNet-foliar-traits-7JAN2017.csv')
leaf[leaf == 'NULL'] <- NA
leaf[, 8:30] <- sapply(leaf[, 8:30], as.character)
leaf[, 8:30] <- sapply(leaf[, 8:30], as.numeric)
leaf$Ntrt = 0
leaf$Ntrt[leaf$trt == 'N' | leaf$trt == 'NP' | leaf$trt == 'NK' | leaf$trt == 'NPK' | leaf$trt == 'NPK+Fence'] = 1
leaf$Ptrt = 0
leaf$Ptrt[leaf$trt == 'P' | leaf$trt == 'NP' | leaf$trt == 'PK' | leaf$trt == 'NPK' | leaf$trt == 'NPK+Fence'] = 1
leaf$Ktrt = 0
leaf$Ktrt[leaf$trt == 'K' | leaf$trt == 'NK' | leaf$trt == 'PK' | leaf$trt == 'NPK' | leaf$trt == 'NPK+Fence'] = 1
leaf$Ntrt_fac = as.factor(leaf$Ntrt)
leaf$Ptrt_fac = as.factor(leaf$Ptrt)
leaf$Ktrt_fac = as.factor(leaf$Ktrt)
leaf$Narea = leaf$leaf_pct_N * (1/leaf$SLA)
leaf$Nfix = 'no'
leaf$Nfix[leaf$Family == 'Fabaceae'] = 'yes'
# add core data to the dataset
core = read.csv('../Data/comb-by-plot-09-April-2018.csv')
core[core == 'NULL'] <- NA
core[, 26:45] <- sapply(core[, 26:45], as.character)
core[, 26:45] <- sapply(core[, 26:45], as.numeric)
core$par_rat = core$Ground_PAR / core$Ambient_PAR
leaf_core = join(leaf, core, by = c("site_code", "year", "block", "plot", "trt"), type = 'left', match = 'first')
# add SPEI to "leaf_core" data
spei = read.csv('../Data/CRU-annual_2018-07-06.csv')
spei$p_pet = spei$precip / spei$PET
leaf_core_spei = join(leaf_core, spei, by = c("site_code", "year"), type = 'left', match = 'first')
# check
nrow(leaf)
nrow(leaf_core) # some core data matches the leaf data twice...
nrow(leaf_core_spei)
hist(leaf_core_spei $leaf_pct_N)
leafNper_lmer = lmer(leaf_pct_N ~ Ntrt_fac * Nfix + p_pet + (1|site_code) + (1|Family) + (1|Taxon) + (1|site_code:Family) + (1|site_code:Taxon), data = leaf_core_spei)
plot(resid(leafNper_lmer) ~ fitted(leafNper_lmer))
Anova(leafNper_lmer)
emmeans(leafNper_lmer, ~Ntrt_fac)
cld(emmeans(leafNper_lmer, ~Ntrt_fac * Nfix)) # percent N is higher in N addition by ~12%
leaf_core_spei$Taxon
leafNper_lmer = lmer(leaf_pct_N ~ Ntrt_fac +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
plot(resid(leafNper_lmer) ~ fitted(leafNper_lmer))
Anova(leafNper_lmer)
emmeans(leafNper_lmer, ~Ntrt_fac)
hist(leaf$Narea)
hist(log(leaf$Narea))
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * Nfix +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
leafNper_lmer = lmer(leaf_pct_N ~ Ntrt_fac * Nfix +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
Anova(leafNper_lmer)
cld(emmeans(leafNper_lmer, ~Ntrt_fac * Nfix)) # percent N is higher in N addition by ~12%
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * Nfix +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
cld(emmeans(leafNarea_lmer, ~Ntrt_fac))
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
leafNarea_lmer
Anova(leafNarea_lmer)
cld(emmeans(leafNarea_lmer, ~Ntrt_fac))
0.14/7.78
summary(emmeans(leafNarea_lmer, ~Ntrt_fac))
(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[2,2] - summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]) / summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]
(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[2,2] - summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]) / -summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
# plot(resid(SLA_lmer) ~ fitted(SLA_lmer))
Anova(SLA_lmer)
SLA_lmer = lmer(log(leaf$SLA) ~ Ntrt_fac +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
# plot(resid(SLA_lmer) ~ fitted(SLA_lmer))
Anova(SLA_lmer)
cld(emmeans(SLA_lmer, ~Ntrt_fac)) # (~1% increase)
(summary(emmeans(SLA_lmer, ~Ntrt_fac))[2,2] - summary(emmeans(SLA_lmer, ~Ntrt_fac))[1,2]) / abs(summary(emmeans(SLA_lmer, ~Ntrt_fac))[1,2])
leaf_core_spei_group = group_by(leaf_core_spei, site_code, year, Ntrt_fac)
leaf_core_spei_mean = summarise_all(leaf_core_spei_group, .funs = funs(Mean = mean(., na.rm = T), SD = sd(., na.rm = T)))
leaf_core_spei_mean_yN = subset(leaf_core_spei_mean, Ntrt_fac == '1')
leaf_core_spei_mean_nN = subset(leaf_core_spei_mean, Ntrt_fac == '0')
nrow(leaf_core_spei_mean_yN)
nrow(leaf_core_spei_mean_nN)
deltaNper = ((leaf_core_spei_mean_yN$leaf_pct_N_Mean - leaf_core_spei_mean_nN$leaf_pct_N_Mean) /
leaf_core_spei_mean_nN$leaf_pct_N_Mean) * 100
deltaNarea = ((leaf_core_spei_mean_yN$Narea_Mean - leaf_core_spei_mean_nN$Narea_Mean) /
leaf_core_spei_mean_nN$Narea_Mean) * 100
deltaNarea = ((leaf_core_spei_mean_yN$Narea_Mean - leaf_core_spei_mean_nN$Narea_Mean) /
leaf_core_spei_mean_nN$Narea_Mean) * 100
# summary(lm(deltaNper ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
summary(lm(deltaNarea ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
# summary(lm(deltaNper ~ leaf_core_spei_mean_nN$precip.mean_Mean)) # nothing
summary(lm(deltaNarea ~ leaf_core_spei_mean_nN$precip.mean_Mean)) # nothing
# plot(deltaNper ~ leaf_core_spei_mean_nN$precip.mean_Mean)
plot(deltaNarea ~ leaf_core_spei_mean_nN$precip.mean_Mean)
lm_deltaNarea = lm(deltaNarea ~ leaf_core_spei_mean_nN$par_rat_Mean)
anova(lm_deltaNarea)
summary(lm_deltaNarea)
# summary(lm(deltaNper ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
anova(lm(deltaNarea ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
# summary(lm(deltaNper ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
anova(lm(deltaNarea ~ leaf_core_spei_mean_nN$p_pet_Mean + leaf_core_spei_mean_nN$par_rat_Mean)) # nothing
# summary(lm(deltaNper ~ leaf_core_spei_mean_nN$p_pet_Mean)) # nothing
anova(lm(deltaNarea ~ leaf_core_spei_mean_nN$p_pet_Mean * leaf_core_spei_mean_nN$par_rat_Mean)) # nothing
hist(leaf_core_spei_mean_nN$par_rat_Mean)
par(mfrow = c(1, 1), oma = c(4, 4, 1, 1))
palette = colorRampPalette(brewer.pal(9,'Blues'))
#p_pet_cols <- palette(9)[as.numeric(cut(biomass_core_spei_nofix_mean_nN$p_pet_Mean,breaks = 9))]
plot(deltaNarea ~ leaf_core_spei_nofix_mean_nN$par_rat_Mean, pch =21, cex = 3, bg = 'blue',  yaxt = 'n', xaxt = 'n', ylab = '', xlab = '', xlim = c(0, 1), ylim = c(-100, 300))
axis(1, seq(0, 1, 0.2), cex.axis = 2)
axis(2, seq(-100, 300, 100), cex.axis = 2, las = 1)
mtext(side = 1, 'Light interception', line = 4, cex = 2)
mtext(side = 2, '∆N per leaf area (%)', line = 5, cex = 2)
palette = colorRampPalette(brewer.pal(9,'Blues'))
#p_pet_cols <- palette(9)[as.numeric(cut(biomass_core_spei_nofix_mean_nN$p_pet_Mean,breaks = 9))]
plot(deltaNarea ~ leaf_core_spei_nofix_mean_nN$par_rat_Mean, pch =21, cex = 3, bg = 'blue',  yaxt = 'n', xaxt = 'n', ylab = '', xlab = '', xlim = c(0, 1), ylim = c(-100, 300))
#p_pet_cols <- palette(9)[as.numeric(cut(biomass_core_spei_nofix_mean_nN$p_pet_Mean,breaks = 9))]
plot(deltaNarea ~ leaf_core_spei_mean_nN$par_rat_Mean, pch =21, cex = 3, bg = 'blue',  yaxt = 'n', xaxt = 'n', ylab = '', xlab = '', xlim = c(0, 1), ylim = c(-100, 300))
axis(1, seq(0, 1, 0.2), cex.axis = 2)
axis(2, seq(-100, 300, 100), cex.axis = 2, las = 1)
mtext(side = 1, 'Light interception', line = 4, cex = 2)
mtext(side = 2, '∆N per leaf area (%)', line = 5, cex = 2)
lines(deltaNarea_line ~ seq(0, 1, 0.1), lwd = 4)
text(0.5, 290, 'p = 0.35; mean = +12%', cex = 1.8)
deltaNarea_line = summary(lm_deltaNarea)$coefficients[1, 1] + summary(lm_deltaNarea)$coefficients[2, 1] * seq(0, 1, 0.1)
lines(deltaNarea_line ~ seq(0, 1, 0.1), lwd = 4)
p_pet_cols <- palette(9)[as.numeric(cut(biomass_core_spei_mean_nN$p_pet_Mean,breaks = 9))]
p_pet_cols <- palette(9)[as.numeric(cut(leaf_core_spei_mean_nN$p_pet_Mean,breaks = 9))]
plot(deltaNarea ~ leaf_core_spei_mean_nN$par_rat_Mean, pch =21, cex = 3, bg = 'blue',  yaxt = 'n', xaxt = 'n', ylab = '', xlab = '', xlim = c(0, 1), ylim = c(-100, 300))
axis(1, seq(0, 1, 0.2), cex.axis = 2)
axis(2, seq(-100, 300, 100), cex.axis = 2, las = 1)
mtext(side = 1, 'Light interception', line = 4, cex = 2)
mtext(side = 2, '∆N per leaf area (%)', line = 5, cex = 2)
lines(deltaNarea_line ~ seq(0, 1, 0.1), lwd = 4)
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * p_pet +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * p_pet +
(1|site_code) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * p_pet * par_rat +
(1|site_code) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
emtrends(leafNarea_lmer, ~1, var = 'p_pet')
emtrends(leafNarea_lmer, ~1, var = 'par_rat')
SLA_lmer = lmer(log(leaf$SLA) ~ Ntrt_fac * p_pet * par_rat +
(1|site_code) + (1|Taxon) + (1|site_code:Taxon),
data = leaf_core_spei)
SLA_lmer = lmer(log(leaf$SLA) ~ Ntrt_fac * p_pet * par_rat +
(1|site_code) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
# plot(resid(SLA_lmer) ~ fitted(SLA_lmer))
Anova(SLA_lmer)
emtrends(SLA_lmer, ~1, var = 'p_pet')
emtrends(SLA_lmer, ~1, var = 'par_rat')
head(leaf_core_spei)
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * p_pet * Ambient_PAR +
(1|site_code) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
emtrends(leafNarea_lmer, ~1, var = 'Ambient_PAR')
SLA_lmer = lmer(log(leaf$SLA) ~ Ntrt_fac * p_pet * Ambient_PAR +
(1|site_code) + (1|site_code:Taxon),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
# plot(resid(SLA_lmer) ~ fitted(SLA_lmer))
Anova(SLA_lmer)
emtrends(SLA_lmer, ~1, var = 'Ambient_PAR')
leafNarea_lmer = lmer(log(Narea) ~ Ntrt_fac * p_pet * Ambient_PAR +
(1|site_code),
data = leaf_core_spei)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[2,2] - summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]) / abs(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2])
emtrends(leafNarea_lmer, ~1, var = 'Ambient_PAR')
test(emtrends(leafNarea_lmer, ~1, var = 'Ambient_PAR'))
SLA_lmer = lmer(log(leaf$SLA) ~ Ntrt_fac * p_pet * Ambient_PAR +
(1|site_code),
data = leaf_core_spei)
test(emtrends(SLA_lmer, ~1, var = 'p_pet'))
test(emtrends(SLA_lmer, ~1, var = 'Ambient_PAR'))
plot = read.csv('../Data/full-biomass-nutrients-06-December-2017.csv')
plot$Ntrt = 0
plot$Ntrt[plot$trt == 'N' | plot$trt == 'NP' | plot$trt == 'NK' | plot$trt == 'NPK' | plot$trt == 'NPK+Fence'] = 1
plot$Ptrt = 0
plot$Ptrt[plot$trt == 'P' | plot$trt == 'NP' | plot$trt == 'PK' | plot$trt == 'NPK' | plot$trt == 'NPK+Fence'] = 1
plot$Ktrt = 0
plot$Ktrt[plot$trt == 'K' | plot$trt == 'NK' | plot$trt == 'PK' | plot$trt == 'NPK' | plot$trt == 'NPK+Fence'] = 1
plot$pct_N_num = as.numeric(as.character(plot$pct_N))
plot$N_tot = as.numeric(as.character(plot$pct_N)) * as.numeric(as.character(plot$mass))
plot$Ntrt_fac = as.factor(plot$Ntrt)
plot$Ptrt_fac = as.factor(plot$Ptrt)
plot$Ktrt_fac = as.factor(plot$Ktrt)
plot$Nfix = 'no'
plot$Nfix[plot$category == "LEGUME"] = 'yes'
plot$Nfix[plot$category == "BRYOPHYTE"] = 'bryo'
## load optimal vcmax functions
source('../../optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('../../optimal_vcmax_R/functions')
## load optimal vcmax functions
source('optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('optimal_vcmax_R/functions')
## load optimal vcmax functions
source('optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('optimal_vcmax_R/functions')
## create hypothesis figure
calc_optimal_vcmax(beta = 200)
## create hypothesis figure
calc_optimal_vcmax(beta = seq(100, 200, 25))
## load optimal vcmax functions
source('optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('optimal_vcmax_R/functions')
## create hypothesis figure
calc_optimal_vcmax(beta = seq(100, 200, 25))
## load optimal vcmax functions
source('optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('optimal_vcmax_R/functions')
## create hypothesis figure
calc_optimal_vcmax(beta = seq(100, 200, 25))
source('n_from_gas_exchange/n_from_gas_exchange.R')
## create hypothesis figure
### leaf N by N supply with different differences in N demand
n_supply_trend = calc_optimal_vcmax(beta = seq(100, 300, 10))
n_supply_trend
fvcmax25_nrubisco(n_supply_trend$vcmax)
n_supply_trend$photo_n = fvcmax25_nrubisco(n_supply_trend$vcmax) + fjmax25_nbioe(n_supply_trend$jmax)
calc_optimal_vcmax
n_supply_trend$photo_n = fvcmax25_nrubisco(n_supply_trend$vcmax) + fjmax25_nbioe(n_supply_trend$jmax)
n_supply_trend$photo_n
hypothesis_plot = ggplot(data = n_supply_trend,
aes(x = (1/beta), y = photo_n)) +
geom_line()
hypothesis_plot
hypothesis_plot = ggplot(data = n_supply_trend,
aes(x = (1/beta), y = photo_n)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line()
hypothesis_plot
n_supply_trend$photo_n_nochange = n_supply_trend$photo_n[1]
n_supply_trend$photo_n_nochange
hypothesis_data = cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nochange))
hypothesis_data = cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nochange),
c(rep('supply', 30), rep('supply_and_demand', 30)))
c(rep('supply', 30), rep('supply_and_demand', 30))
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nochange)
c(n_supply_trend$beta, n_supply_trend$beta)
n_supply_trend
hypothesis_data = cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nochange),
c(rep('supply', 21), rep('supply_and_demand', 21)))
n_supply_trend = calc_optimal_vcmax(beta = seq(100, 300, 10))
n_supply_trend$photo_n = fvcmax25_nrubisco(n_supply_trend$vcmax) + fjmax25_nbioe(n_supply_trend$jmax)
n_supply_trend$photo_n_nobetachange = n_supply_trend$photo_n[1]
hypothesis_data = cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21)))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data = cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21)))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line(width = 6, col = )
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line(width = 6, col = )
hypothesis_data
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line(width = 6)
hypothesis_plot
hypothesis_data$beta
hypothesis_data = data.frame(cbind(as.numeric(c(n_supply_trend$beta, n_supply_trend$beta)),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data$beta
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
hypothesis_data
hypothesis_data$X1
hypothesis_data$beta = as.numeric(as.character(hypothesis_data$beta))
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data$beta = as.numeric(as.character(hypothesis_data$beta))
hypothesis_data$beta
hypothesis_data$Narea = as.numeric(as.character(hypothesis_data$Narea))
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line(width = 6)
hypothesis_plot
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line()
hypothesis_plot
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea, col = demand)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line()
hypothesis_plot
n_supply_trend$photo_n_nobetachange = n_supply_trend$photo_n[21]
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data$beta = as.numeric(as.character(hypothesis_data$beta))
hypothesis_data$Narea = as.numeric(as.character(hypothesis_data$Narea))
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea, col = demand)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line()
hypothesis_plot
n_supply_trend$photo_n_nobetachange = n_supply_trend$photo_n[10]
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data$beta = as.numeric(as.character(hypothesis_data$beta))
hypothesis_data$Narea = as.numeric(as.character(hypothesis_data$Narea))
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea, col = demand)) +
theme(legend.position = 'none',
axis.title.y=element_text(size=rel(3), colour = 'black'),
axis.title.x=element_text(size=rel(3), colour = 'black'),
axis.text.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.y=element_text(size=rel(2.5), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line()
hypothesis_plot
n_supply_trend
