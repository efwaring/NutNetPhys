## load scripts
source('optimal_vcmax_R')
calc_optimal_vcmax
## load libraries
library(R.utils)
install.packages('R.utils')
## load libraries
library(R.utils)
## load scripts
sourceDirectory('optimal_vcmax_R')
## load scripts
sourceDirectory('optimal_vcmax_R')
## load scripts
sourceDirectory('optimal_vcmax_R')
## load scripts
source('../calc_optimal_vcmax.R')
## load scripts
source('optimal_vcmax_R/calc_optimal_vcmax.R')
## load observational data
traits = read.csv('../Data/NutNet-foliar-traits-7JAN2017.csv')
head(traits)
## calculate lma and narea
traits$lma = 1 / traits$SLA
traits$SLA
as.numeric(traits$SLA)
as.numeric(as.character(traits$SLA))
## calculate lma and narea
traits$lma = 1 / as.numeric(as.character(traits$SLA))
traits$lma
## calculate lma (in g cm-2) and narea
traits$lma = 1 / (as.numeric(as.character(traits$SLA)) * 0.01)
traits$lma
1e-6
## calculate lma (in g m-2) and narea
traits$lma = 1 / (as.numeric(as.character(traits$SLA)) * 1e-6)
traits$lma
traits$narea = as.numeric(as.character(traits$leaf_pct_N)) * traits$lma
traits$narea
hist(traits$lma)
hist(traits$narea)
hist
?hist
## load observational data
traits = read.csv('../Data/leaf_plus.csv')
head(traits)
traits$SLA
colnames(traits)
## calculate lma (in g m-2) and narea
traits$lma = 1 / (traits$SLA * 1e-6)
traits$narea = traits$leaf_pct_N * traits$lma
hist(traits$lma) # some extremely high values
hist(traits$narea) # some extremely high values
## calculate optimal trait values
calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400, vpdo = traits$vpd,
z = traits$z)
## calculate optimal trait values
traits$vcmax_opt = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)
calc_tresp_mult
traits$vcmax25_opt = traits$vcmax_opt / calc_tresp_mult(traits$tmp, traits$tmp,
25)
calc_tresp_mult(traits$tmp, traits$tmp,
25)
traits$tmp
## calculate optimal trait values
traits$vcmax_mod = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)
traits$vcmax25_mod = traits$vcmax_opt / calc_tresp_mult(traits$tmp, traits$tmp,
25)
traits$n_rubisco_mod =
traits$n_structure_mod = = 10^(âˆ’2.67) * traits$lma * 0.99
traits$n_rubisco_mod =
traits$n_structure_mod = 10^(âˆ’2.67) * traits$lma * 0.99
traits$n_rubisco_mod =
traits$n_structure_mod = 10^(-2.67) * traits$lma * 0.99
traits$n_rubisco_mod =
traits$n_structure_mod = 10^(-2.67) * traits$lma * 0.99
traits$n_structure_mod
traits$n_rubisco_mod =
traits$n_structure_mod = (10^(-2.67)) * traits$lma * 0.99
traits$n_structure_mod
traits$n_rubisco_mod =
traits$n_structure_mod = (10^(-2.67)) * (traits$lma ^ 0.99)
traits$n_structure_mod
(traits$lma ^ 0.99)
(10^(-2.67))
10^-2.67
traits$lma
1e-6 * 1
1/1000000
.0000001 * 1
## calculate lma (in g m-2) and narea
traits$lma = 1 / (traits$SLA * 10e-6)
traits$lma
## calculate lma (in g m-2) and narea
traits$lma = 1 / (traits$SLA * 1e-6)
traits$lma
## calculate N from rubisco and structure
### specific activity of rubisco is 60 umol CO2 gRubisco-1 s-1
### mass ratio of rubisco is 7.16 gRubisco gNRubisco-1
traits$n_rubisco_mod = traits$vcmax25_mod * (1/60) * (1/7.16)
traits$n_rubisco_mod
hist(traits$n_rubisco_mod)
traits$n_rubisco_mod
class(traits$n_rubisco_mod)
traits$vcmax_mod
## calculate optimal trait values
traits$vcmax_mod = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)$vcmax_prime
traits$vcmax25_mod = traits$vcmax_opt / calc_tresp_mult(traits$tmp, traits$tmp,
25)
## calculate N from rubisco and structure
### specific activity of rubisco is 60 umol CO2 gRubisco-1 s-1
### mass ratio of rubisco is 7.16 gRubisco gNRubisco-1
traits$n_rubisco_mod = traits$vcmax25_mod * (1/60) * (1/7.16)
traits$n_structure_mod = (10^-2.67) * (traits$lma ^ 0.99)
hist(traits$n_rubisco_mod)
traits$vcmax25_mod = traits$vcmax_mod / calc_tresp_mult(traits$tmp, traits$tmp,
25)
## calculate N from rubisco and structure
### specific activity of rubisco is 60 umol CO2 gRubisco-1 s-1
### mass ratio of rubisco is 7.16 gRubisco gNRubisco-1
traits$n_rubisco_mod = traits$vcmax25_mod * (1/60) * (1/7.16)
traits$n_structure_mod = (10^-2.67) * (traits$lma ^ 0.99)
hist(traits$n_rubisco_mod)
hist(traits$n_structure_mod)
traits$n_structure_mod
## compare modeled and observed N
n_pred_lm = lm(narea ~ n_rubisco_mod + n_structure_mod, data = traits)
anova(n_pred_lm)
summary(n_pred_lm)
head(traits)
## load observational data
traits = read.csv('../Data/leaf_plus.csv')
head(traits)
## calculate lma (in g m-2) and narea
traits$lma = 1 / (traits$SLA * 1e-6)
traits$narea = traits$leaf_pct_N * traits$lma
hist(traits$lma) # some extremely high values
hist(traits$narea) # some extremely high values
## calculate optimal trait values
traits$vcmax_mod = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)$vcmax_prime
traits$vcmax25_mod = traits$vcmax_mod / calc_tresp_mult(traits$tmp, traits$tmp,
25)
## calculate N from rubisco and structure
### specific activity of rubisco is 60 umol CO2 gRubisco-1 s-1
### mass ratio of rubisco is 7.16 gRubisco gNRubisco-1
traits$n_rubisco_mod = traits$vcmax25_mod * (1/60) * (1/7.16)
traits$n_structure_mod = (10^-2.67) * (traits$lma ^ 0.99)
hist(traits$n_rubisco_mod)
hist(traits$n_structure_mod)
head(traits)
## compare modeled and observed N
n_pred_lm = lm(narea ~ n_rubisco_mod + n_structure_mod + Nfix, data = traits)
anova(n_pred_lm)
summary(n_pred_lm)
## compare modeled and observed N
n_pred_lm = lm(narea ~ n_rubisco_mod + n_structure_mod, data = traits)
anova(n_pred_lm)
summary(n_pred_lm)
## make a plot or two
traits$n_rubisco_structure_mod = traits$n_rubisco_mod + traits$n_structure_mod
plot(traits$narea ~ traits$n_rubisco_structure_mod)
traits$SLA
traits$lma
(traits$SLA * (1 / 1000000))
## calculate lma (in g m-2) and narea
traits$lma = 1 / (traits$SLA * (1 / 1000000)) # conver mm2 g-1 to g m-2
traits$lma
hist(traits$lma)
hist(traits$lma, xlim = c(0, 500))
plot(traits$lma)
plot(traits$lma, ylim = c(0, 500))
plot(traits$narea, ylim = c(0, 500))
hist(traits$leaf_pct_N)
plot(traits$narea ~ traits$n_rubisco_structure_mod) # some very high LMA values (very low SLA)
## compare modeled and observed N
### first remove very high lma (>1000 g m-2)
traits_sub = filter(traits, lma < 1000)
?filter
## compare modeled and observed N
### first remove very high lma (>1000 g m-2)
traits_sub = subset(traits, lma < 1000)
n_pred_lm = lm(narea ~ n_rubisco_mod + n_structure_mod, data = traits_sub)
anova(n_pred_lm)
summary(n_pred_lm)
## make a plot or two
traits_sub$n_rubisco_structure_mod = traits_sub$n_rubisco_mod + traits_sub$n_structure_mod
plot(traits_sub$narea ~ traits_sub$n_rubisco_structure_mod) # some very high LMA values (very low SLA)
traits$narea = traits$leaf_pct_N * (1 /traits$lma)
hist(traits$lma) # some extremely high values
hist(traits$narea) # some extremely high values
## calculate optimal trait values
traits$vcmax_mod = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)$vcmax_prime
traits$vcmax25_mod = traits$vcmax_mod / calc_tresp_mult(traits$tmp, traits$tmp,
25)
hist(traits$narea) # some extremely high values
traits$narea = (traits$leaf_pct_N / 100) * (traits$lma)
hist(traits$lma) # some extremely high values
hist(traits$narea) # some extremely high values
## calculate optimal trait values
traits$vcmax_mod = calc_optimal_vcmax(tg_c = traits$tmp, paro = traits$par, cao = 400,
vpdo = traits$vpd, z = traits$z)$vcmax_prime
traits$vcmax25_mod = traits$vcmax_mod / calc_tresp_mult(traits$tmp, traits$tmp,
25)
## compare modeled and observed N
### first remove very high lma (>1000 g m-2)
traits_sub = subset(traits, lma < 1000)
n_pred_lm = lm(narea ~ n_rubisco_mod + n_structure_mod, data = traits_sub)
anova(n_pred_lm)
summary(n_pred_lm)
## make a plot or two
traits_sub$n_rubisco_structure_mod = traits_sub$n_rubisco_mod + traits_sub$n_structure_mod
plot(traits_sub$narea ~ traits_sub$n_rubisco_structure_mod) # some very high LMA values (very low SLA)
plot(traits_sub$narea ~ traits_sub$n_rubisco_mod) #
plot(traits_sub$narea ~ traits_sub$n_structure_mod) #
plot(traits_sub$narea ~ traits_sub$n_rubisco_mod) #
hist(traits$n_rubisco_mod)
plot(traits_sub$narea ~ traits_sub$n_rubisco_mod) # not a great relationship
