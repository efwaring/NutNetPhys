#########################################
library(lme4)
library(car)
library(emmeans)
library(dplyr)
library(RColorBrewer)
library(multcompView)
library(ggplot2)
#########################################
# read in and modify foliar trait dataset (Jen Firn)
#########################################
## load observational data
traits = read.csv('../Data/leaf_plus.csv')
head(traits)
## fiter by overlapping sites
source('filter_sites.R')
traits = filter(traits, site_code %in% overlap)
## make sure factors are correctly defined
traits$Ntrt_fac = as.factor(traits$Ntrt_fac)
traits$Ptrt_fac = as.factor(traits$Ptrt_fac)
traits$Ktrt_fac = as.factor(traits$Ktrt_fac)
## add in photosynthetic pathway information
levels(traits$Family) # check Amaranthaceae, Asteraceae, Boraginaceae, Caryophyllaceae, Cyperaceae, Euphorbiaceae,
# Polygonaceae, Poaceae, Scrophulariaceae
# only one!
# C4
traits$photosynthetic_pathway[traits$photosynthetic_pathway == 'NULL'
& traits$Family == 'Cyperaceae' & traits$Taxon == 'FIMBRISTYLIS DICHOTOMA'] <- 'C4'
traits$photosynthetic_pathway[traits$photosynthetic_pathway == 'NULL'] <- 'C3'
## calculate lma (in g m-2) and narea
hist(traits$leaf_area_mm2)
traits$la_m2 = traits$leaf_area_mm2 * (1/1000000)
traits$lma = 1/traits$SLA
traits$narea = (traits$leaf_pct_N / 100) * (1/traits$SLA) * 1000000
# hist(traits$lma) # some extremely high values
# hist(traits$narea) # some extremely high values
# hist(traits$SLA)
# hist(traits$la_m2)
# hist(traits$leaf_dry_mass_g) # some very hig values
# hist(subset(traits, leaf_dry_mass_g < 100)$leaf_dry_mass_g)
## some light calculations
traits$lai = -log(traits$Ground_PAR / traits$Ambient_PAR) / 0.86 # from: http://manuals.decagon.com/Manuals/10242_Accupar%20LP80_Web.pdf page 41
# hist(traits$lai)
### calculate par per leaf area to assume par absorbed is reduced in dense canopies
traits$par_per_leaf_area = traits$par * ((1 - exp(-0.5 * traits$lai)) / traits$lai) # from Dong et al. (2007) eqn 2
# hist(traits$par_per_leaf_area)
# hist(traits$Ambient_PAR)
# hist(traits$par)
# hist(((1 - exp(-0.5 * traits$lai)) / traits$lai))
## remove C4 and values without d13c
traits_sub = subset(traits, lma > 0 & leaf_dry_mass_g < 100 & photosynthetic_pathway == 'C3' & leaf_C13_delta_PDB != 'NA'
& leaf_C13_delta_PDB < -20 & trt != 'Fence' & trt != 'NPK+Fence')
traits_sub$delta = (-8 - traits_sub$leaf_C13_delta_PDB) / (1 + traits_sub$leaf_C13_delta_PDB * 0.001)
traits_sub$chi = (traits_sub$delta - 4.4) / (27 - 4.4)
traits_sub = subset(traits_sub, tmp > 5)
# hist(traits_sub$lma) # some extremely high values
# hist(traits_sub$narea) # some extremely high values
# hist(traits_sub$la_m2)
# hist(traits_sub$leaf_dry_mass_g) #
# hist(traits_sub$chi) # looks good
write.csv(traits_sub, '../Data/processed/traits.csv')
traits_sub_group_by_site = group_by(traits_sub,
site_code, plot, block, trt, Ntrt_fac, Ptrt_fac, Ktrt_fac)
traits_sub_site = summarise(traits_sub_group_by_site,
narea_mean = mean(narea, na.rm = T),
chi_mean = mean(chi, na.rm = T),
tmp_mean = mean(tmp, na.rm = T),
lma_mean = mean(lma, na.rm = T),
par_per_leaf_area_mean = mean(par_per_leaf_area, na.rm = T),
lai_mean = mean(lai, na.rm = T),
p_pet_mean = mean(p_pet, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
write.csv(traits_sub_site, '../Data/processed/traits_site.csv')
### load data
leaf = read.csv('../Data/processed/traits.csv')
leaf$Ntrt_fac = as.factor(leaf$Ntrt)
leaf$Ptrt_fac = as.factor(leaf$Ptrt)
leaf$Ktrt_fac = as.factor(leaf$Ktrt)
leaf_Nonly = subset(leaf, Ptrt_fac == '0' & Ktrt_fac == '0')
leaf_site = read.csv('../Data/processed/traits_site.csv')
leaf_site$Ntrt_fac = as.factor(leaf_site$Ntrt)
leaf_site$Ptrt_fac = as.factor(leaf_site$Ptrt)
leaf_site$Ktrt_fac = as.factor(leaf_site$Ktrt)
leaf_site$block_fac = as.factor(leaf_site$block)
leaf_site_Nonly = subset(leaf_site, Ptrt_fac == '0' & Ktrt_fac == '0')
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf_Nonly$tmp,
paro = leaf_Nonly$par_per_leaf_area,
cao = 400,
vpdo = leaf_Nonly$vpd,
z = leaf_Nonly$z,
chi = leaf_Nonly$chi)
leaf_Nonly$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$nrubisco = fvcmax25_nrubisco(leaf_Nonly$vcmax25)
leaf_Nonly$nbioe = fjmax25_nbioe(leaf_Nonly$jmax25)
leaf_Nonly$nstructure = flma_nstructure(leaf_Nonly$lma)
leaf_Nonly$nall = leaf_Nonly$nrubisco + leaf_Nonly$nbioe + leaf_Nonly$nstructure
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
leaf_Nonly$narea
# Narea preprocessing
#########################################
# packages necessary
#########################################
library(lme4)
library(car)
library(emmeans)
library(dplyr)
library(RColorBrewer)
library(multcompView)
library(ggplot2)
#########################################
# read in and modify foliar trait dataset (Jen Firn)
#########################################
## load observational data
traits = read.csv('../Data/leaf_plus.csv')
head(traits)
## fiter by overlapping sites
source('filter_sites.R')
traits = filter(traits, site_code %in% overlap)
## make sure factors are correctly defined
traits$Ntrt_fac = as.factor(traits$Ntrt_fac)
traits$Ptrt_fac = as.factor(traits$Ptrt_fac)
traits$Ktrt_fac = as.factor(traits$Ktrt_fac)
## add in photosynthetic pathway information
levels(traits$Family) # check Amaranthaceae, Asteraceae, Boraginaceae, Caryophyllaceae, Cyperaceae, Euphorbiaceae,
# Polygonaceae, Poaceae, Scrophulariaceae
# only one!
# C4
traits$photosynthetic_pathway[traits$photosynthetic_pathway == 'NULL'
& traits$Family == 'Cyperaceae' & traits$Taxon == 'FIMBRISTYLIS DICHOTOMA'] <- 'C4'
traits$photosynthetic_pathway[traits$photosynthetic_pathway == 'NULL'] <- 'C3'
## calculate lma (in g m-2) and narea
hist(traits$leaf_area_mm2)
traits$la_m2 = traits$leaf_area_mm2 * (1/1000000)
traits$lma = traits$leaf_dry_mass_g / traits$la_m2
traits$narea = (traits$leaf_pct_N / 100) * (traits$lma)
# hist(traits$lma) # some extremely high values
# hist(traits$narea) # some extremely high values
# hist(traits$SLA)
# hist(traits$la_m2)
# hist(traits$leaf_dry_mass_g) # some very hig values
# hist(subset(traits, leaf_dry_mass_g < 100)$leaf_dry_mass_g)
## some light calculations
traits$lai = -log(traits$Ground_PAR / traits$Ambient_PAR) / 0.86 # from: http://manuals.decagon.com/Manuals/10242_Accupar%20LP80_Web.pdf page 41
# hist(traits$lai)
### calculate par per leaf area to assume par absorbed is reduced in dense canopies
traits$par_per_leaf_area = traits$par * ((1 - exp(-0.5 * traits$lai)) / traits$lai) # from Dong et al. (2007) eqn 2
# hist(traits$par_per_leaf_area)
# hist(traits$Ambient_PAR)
# hist(traits$par)
# hist(((1 - exp(-0.5 * traits$lai)) / traits$lai))
## remove C4 and values without d13c
traits_sub = subset(traits, lma > 0 & leaf_dry_mass_g < 100 & photosynthetic_pathway == 'C3' & leaf_C13_delta_PDB != 'NA'
& leaf_C13_delta_PDB < -20 & trt != 'Fence' & trt != 'NPK+Fence')
traits_sub$delta = (-8 - traits_sub$leaf_C13_delta_PDB) / (1 + traits_sub$leaf_C13_delta_PDB * 0.001)
traits_sub$chi = (traits_sub$delta - 4.4) / (27 - 4.4)
traits_sub = subset(traits_sub, tmp > 5)
# hist(traits_sub$lma) # some extremely high values
# hist(traits_sub$narea) # some extremely high values
# hist(traits_sub$la_m2)
# hist(traits_sub$leaf_dry_mass_g) #
# hist(traits_sub$chi) # looks good
write.csv(traits_sub, '../Data/processed/traits.csv')
traits_sub_group_by_site = group_by(traits_sub,
site_code, plot, block, trt, Ntrt_fac, Ptrt_fac, Ktrt_fac)
traits_sub_site = summarise(traits_sub_group_by_site,
narea_mean = mean(narea, na.rm = T),
chi_mean = mean(chi, na.rm = T),
tmp_mean = mean(tmp, na.rm = T),
lma_mean = mean(lma, na.rm = T),
par_per_leaf_area_mean = mean(par_per_leaf_area, na.rm = T),
lai_mean = mean(lai, na.rm = T),
p_pet_mean = mean(p_pet, na.rm = T),
live_mass_mean = mean(live_mass, na.rm = T))
write.csv(traits_sub_site, '../Data/processed/traits_site.csv')
# Script using least-cost to explore Narea response at nutnet
#####################################################################
## load packages
#####################################################################
library(tidyverse)
library(lme4)
library(car)
library(r2glmm)
library(treemapify)
#####################################################################
## load functions
#####################################################################
source('optimal_vcmax_R/calc_optimal_vcmax.R')
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
sourceDirectory('optimal_vcmax_R/functions')
source('n_from_gas_exchange/n_from_gas_exchange.R')
multiplot <- function(..., plotlist=NULL, cols) {
require(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# Make the panel
plotCols = cols                          # Number of columns of plots
plotRows = ceiling(numPlots/plotCols) # Number of rows needed, calculated from # of cols
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(plotRows, plotCols)))
vplayout <- function(x, y)
viewport(layout.pos.row = x, layout.pos.col = y)
# Make each plot, in the correct location
for (i in 1:numPlots) {
curRow = ceiling(i/plotCols)
curCol = (i-1) %% plotCols + 1
print(plots[[i]], vp = vplayout(curRow, curCol ))
}
}
calc_vcmax_tresp_mult = function(tleaf, tmean, tref){
temp = tleaf + 273.15
Ha= 71513
Hd= 200000
adelS= 668.39
bdelS= -1.07
tmeanK=tmean+273.15
trefK=tref+273.15
R=8.314
kbeg=exp(Ha*(temp-trefK)/(trefK*R*temp))
kend=((1+exp((trefK*(adelS+bdelS*tmean)-Hd)/(trefK*R)))/(1+exp((temp*(adelS+bdelS*tmean)-Hd)/(temp*R))))
kbeg*kend
}
calc_jmax_tresp_mult = function(tleaf, tmean, tref){
temp = tleaf + 273.15
Ha= 49884
Hd= 200000
adelS= 659.7
bdelS= -0.75
tmeanK=tmean+273.15
trefK=tref+273.15
R=8.314
kbeg=exp(Ha*(temp-trefK)/(trefK*R*temp))
kend=((1+exp((trefK*(adelS+bdelS*tmean)-Hd)/(trefK*R)))/(1+exp((temp*(adelS+bdelS*tmean)-Hd)/(temp*R))))
kbeg*kend
}
#####################################################################
## create hypothesis figure
### leaf N and chi by N supply with different differences in N demand
#####################################################################
n_supply_trend = calc_optimal_vcmax(beta = seq(100, 300, 10))
n_supply_trend$photo_n = fvcmax25_nrubisco(n_supply_trend$vcmax) + fjmax25_nbioe(n_supply_trend$jmax)
n_supply_trend$photo_n_nobetachange = n_supply_trend$photo_n[10]
hypothesis_data = data.frame(cbind(c(n_supply_trend$beta, n_supply_trend$beta),
c(n_supply_trend$photo_n, n_supply_trend$photo_n_nobetachange),
c(rep('no_change', 21), rep('change', 21))))
colnames(hypothesis_data) = c('beta', 'Narea', 'demand')
hypothesis_data$beta = as.numeric(as.character(hypothesis_data$beta))
hypothesis_data$Narea = as.numeric(as.character(hypothesis_data$Narea))
hypothesis_plot = ggplot(data = hypothesis_data,
aes(x = (1/beta), y = Narea, col = demand)) +
theme(legend.position = c(0.3, 0.9),
legend.text = element_text(size = 25),
axis.title.y=element_text(size=rel(4), colour = 'black'),
axis.title.x=element_text(size=rel(4), colour = 'black'),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.x=element_blank(),
axis.ticks.y=element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey"),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black")) +
geom_line(size = 4, aes(linetype = demand, color = demand)) +
scale_linetype_manual(values = c(1, 2), guide = F) +
scale_colour_manual(values = c('black', 'grey'),
labels = c('∆N demand = ∆N supply', '∆N demand = 0')) +
guides(color = guide_legend(title = NULL)) +
ylab(expression('Leaf ' * italic('N')['area'])) +
xlab('N supply')
jpeg(filename = "plots/hypothesis_plot.jpeg", width = 600, height = 700, units = 'px')
plot(hypothesis_plot)
dev.off()
#####################################################################
## soil N effects on leaf traits (Narea and chi)
#####################################################################
### load data
leaf = read.csv('../Data/processed/traits.csv')
leaf$Ntrt_fac = as.factor(leaf$Ntrt)
leaf$Ptrt_fac = as.factor(leaf$Ptrt)
leaf$Ktrt_fac = as.factor(leaf$Ktrt)
leaf_Nonly = subset(leaf, Ptrt_fac == '0' & Ktrt_fac == '0')
### run analyses
# hist(leaf$narea)
# hist(log(leaf$narea))
leafNarea_lmer = lmer(log(narea) ~ Ntrt_fac +
(1|site_code),
data = leaf_Nonly)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafNarea_lmer)
cld(emmeans(leafNarea_lmer, ~Ntrt_fac))
(exp(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2])) /
exp(abs(summary(emmeans(leafNarea_lmer, ~Ntrt_fac))[1,2]))
r2beta(leafNarea_lmer, partial = T)
# hist(leaf$chi)
# hist(log(leaf$Narea))
leafchi_lmer = lmer(chi ~ Ntrt_fac +
(1|site_code),
data = leaf_Nonly)
# plot(resid(leafNarea_lmer) ~ fitted(leafNarea_lmer))
Anova(leafchi_lmer)
cld(emmeans(leafchi_lmer, ~Ntrt_fac))
(summary(emmeans(leafchi_lmer, ~Ntrt_fac))[2,2] - summary(emmeans(leafchi_lmer, ~Ntrt_fac))[1,2]) /
abs(summary(emmeans(leafchi_lmer, ~Ntrt_fac))[1,2])
r2beta(leafchi_lmer, partial = T)
### make figure
narea_plot = ggplot(data = leaf_Nonly,
aes(x = Ntrt_fac, y = log(narea))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.1, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('') +
ylab(expression('Log leaf ' * italic('N')['area'])) +
annotate("text", x = 1.5, y = 6.7, label = "p = 0.82", size = 8)
chi_plot = ggplot(data = leaf_Nonly,
aes(x = Ntrt_fac, y = chi)) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.005, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('Nitrogen treatment') +
ylab(expression('C'[i] * '/C'[a])) +
annotate("text", x = 1.5, y = 0.93, label = "p = 0.05", size = 8)
jpeg(filename = "plots/leaf_plot.jpeg", width = 550, height = 900, units = 'px')
multiplot(narea_plot, chi_plot, cols=1)
dev.off()
#####################################################################
## soil N effects on LAI
#####################################################################
leaf_site = read.csv('../Data/processed/traits_site.csv')
leaf_site$Ntrt_fac = as.factor(leaf_site$Ntrt)
leaf_site$Ptrt_fac = as.factor(leaf_site$Ptrt)
leaf_site$Ktrt_fac = as.factor(leaf_site$Ktrt)
leaf_site$block_fac = as.factor(leaf_site$block)
leaf_site_Nonly = subset(leaf_site, Ptrt_fac == '0' & Ktrt_fac == '0')
# hist(leaf_site_Nonly$lai_mean)
# hist(log(leaf_site_Nonly$lai_mean))
lai_lmer = lmer(log(lai_mean) ~ Ntrt_fac +
(1|site_code) + (1|site_code:block),
data = leaf_site_Nonly)
# plot(resid(lai_lmer) ~ fitted(lai_lmer))
Anova(lai_lmer)
cld(emmeans(lai_lmer, ~Ntrt_fac))
(exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[1,2])) /
abs(exp(summary(emmeans(lai_lmer, ~Ntrt_fac))[1,2]))
# hist(leaf_site_Nonly$live_mass_mean)
# hist(log(leaf_site_Nonly$live_mass_mean))
live_mass_lmer = lmer(log(live_mass_mean) ~ Ntrt_fac +
(1|site_code) + (1|site_code:block),
data = leaf_site_Nonly)
# plot(resid(live_mass_lmer) ~ fitted(live_mass_lmer))
Anova(live_mass_lmer)
cld(emmeans(live_mass_lmer, ~Ntrt_fac))
(exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[2,2]) - exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[1,2])) /
abs(exp(summary(emmeans(live_mass_lmer, ~Ntrt_fac))[1,2]))
lai_plot = ggplot(data = leaf_site_Nonly,
aes(x = Ntrt_fac, y = log(lai_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.1, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('') +
ylab(expression('Log LAI (m' ^ '2' *' m' ^'-2' * ')')) +
annotate("text", x = 1.5, y = 1.3, label = "p < 0.05", size = 8)
live_mass_plot = ggplot(data = leaf_site_Nonly,
aes(x = Ntrt_fac, y = log(live_mass_mean))) +
theme(legend.position = "none",
axis.title.y=element_text(size=rel(2.5), colour = 'black'),
axis.title.x=element_text(size=rel(2.5), colour = 'black'),
axis.text.x=element_text(size=rel(2), colour = 'black'),
axis.text.y=element_text(size=rel(2), colour = 'black'),
panel.background = element_rect(fill = 'white', colour = 'black'),
panel.grid.major = element_line(colour = "grey")) +
geom_boxplot(outlier.color = NA, fill = 'white') +
geom_dotplot(binaxis = 'y', binwidth = 0.07, stackdir = 'center', alpha = 0.5) +
scale_x_discrete(labels = c('Ambient', 'Added N')) +
xlab('Nitrogen treatment') +
ylab(expression('Log Biomass (g m' ^ '2' * ')')) +
annotate("text", x = 1.5, y = 7.3, label = "p < 0.01", size = 8)
jpeg(filename = "plots/plant_plot.jpeg", width = 550, height = 900, units = 'px')
multiplot(lai_plot, live_mass_plot, cols=1)
dev.off()
#####################################################################
## Narea predictions
#####################################################################
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf_Nonly$tmp,
paro = leaf_Nonly$par_per_leaf_area,
cao = 400,
vpdo = leaf_Nonly$vpd,
z = leaf_Nonly$z,
chi = leaf_Nonly$chi)
leaf_Nonly$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$nrubisco = fvcmax25_nrubisco(leaf_Nonly$vcmax25)
leaf_Nonly$nbioe = fjmax25_nbioe(leaf_Nonly$jmax25)
leaf_Nonly$nstructure = flma_nstructure(leaf_Nonly$lma)
leaf_Nonly$nall = leaf_Nonly$nrubisco + leaf_Nonly$nbioe + leaf_Nonly$nstructure
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
leafNarea_traits_lmer = lmer(log(narea) ~
chi + lma +
(1|site_code),
data = leaf_Nonly)
Anova(leafNarea_traits_lmer)
plot(resid(leafNarea_traits_lmer) ~ fitted(leafNarea_traits_lmer))
emtrends(leafNarea_traits_lmer, ~1, var = 'chi')
emtrends(leafNarea_traits_lmer, ~1, var = 'lma')
r2beta(leafNarea_traits_lmer, partial = T)
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
source('optimal_vcmax_R/calc_optimal_vcmax.R')
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
sourceDirectory('optimal_vcmax_R/functions')
source('n_from_gas_exchange/n_from_gas_exchange.R')
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf_Nonly$tmp,
paro = leaf_Nonly$par_per_leaf_area,
cao = 400,
vpdo = leaf_Nonly$vpd,
z = leaf_Nonly$z,
chi = leaf_Nonly$chi)
leaf_Nonly$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$nrubisco = fvcmax25_nrubisco(leaf_Nonly$vcmax25)
leaf_Nonly$nbioe = fjmax25_nbioe(leaf_Nonly$jmax25)
leaf_Nonly$nstructure = flma_nstructure(leaf_Nonly$lma)
leaf_Nonly$nall = leaf_Nonly$nrubisco + leaf_Nonly$nbioe + leaf_Nonly$nstructure
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
source('optimal_vcmax_R/calc_optimal_vcmax.R')
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
sourceDirectory('optimal_vcmax_R/functions')
source('n_from_gas_exchange/n_from_gas_exchange.R')
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf_Nonly$tmp,
paro = leaf_Nonly$par_per_leaf_area,
cao = 400,
vpdo = leaf_Nonly$vpd,
z = leaf_Nonly$z,
chi = leaf_Nonly$chi)
leaf_Nonly$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$nrubisco = fvcmax25_nrubisco(leaf_Nonly$vcmax25)
leaf_Nonly$nbioe = fjmax25_nbioe(leaf_Nonly$jmax25)
leaf_Nonly$nstructure = flma_nstructure(leaf_Nonly$lma)
leaf_Nonly$nall = leaf_Nonly$nrubisco + leaf_Nonly$nbioe + leaf_Nonly$nstructure
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
source('optimal_vcmax_R/calc_optimal_vcmax.R')
source('optimal_vcmax_R/calc_optimal_vcmax_knownchi.R')
sourceDirectory('optimal_vcmax_R/functions')
source('n_from_gas_exchange/n_from_gas_exchange.R')
gas_exchange_pred = calc_optimal_vcmax_knownchi(tg_c = leaf_Nonly$tmp,
paro = leaf_Nonly$par_per_leaf_area,
cao = 400,
vpdo = leaf_Nonly$vpd,
z = leaf_Nonly$z,
chi = leaf_Nonly$chi)
leaf_Nonly$vcmax25 = gas_exchange_pred$vcmax /
calc_vcmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$jmax25 = gas_exchange_pred$jmax /
calc_jmax_tresp_mult(gas_exchange_pred$tg_c, gas_exchange_pred$tg_c, 25)
leaf_Nonly$nrubisco = fvcmax25_nrubisco(leaf_Nonly$vcmax25)
leaf_Nonly$nbioe = fjmax25_nbioe(leaf_Nonly$jmax25)
leaf_Nonly$nstructure = flma_nstructure(leaf_Nonly$lma)
leaf_Nonly$nall = leaf_Nonly$nrubisco + leaf_Nonly$nbioe + leaf_Nonly$nstructure
plot(leaf_Nonly$narea ~ leaf_Nonly$nall)
plot(leaf_Nonly$narea ~ leaf_Nonly$nall, xlim = c(0,5))
plot(leaf_Nonly$narea ~ leaf_Nonly$nall, xlim = c(0,5), ylim = c(0, 50))
plot(leaf_Nonly$narea ~ leaf_Nonly$nall, xlim = c(0,1), ylim = c(0, 10))
plot(leaf_Nonly$narea ~ leaf_Nonly$nall * 10)
leaf_Nonly$nall * 10
plot(leaf_Nonly$narea ~ leaf_Nonly$nall * 10)
plot(leaf_Nonly$narea ~ (leaf_Nonly$nall * 10))
(leaf_Nonly$nall * 10)
leaf_Nonly$narea
plot(leaf_Nonly$narea ~ (leaf_Nonly$nall * 10))
test = (leaf_Nonly$nall * 10)
plot(leaf_Nonly$narea ~ test)
abline(0,1)
npred_lm = lm(narea ~ nall, data = leaf_Nonly)
Anova(npred_lm)
npred_lm = lm(narea ~ nall + Ntrt_fac, data = leaf_Nonly)
Anova(npred_lm)
npred_lm = lm(narea ~ nall * Ntrt_fac, data = leaf_Nonly)
Anova(npred_lm)
r2beta(npred_lm, partial = T)
npred_lm = lm(narea ~ nall + Ntrt_fac, data = leaf_Nonly)
Anova(npred_lm)
r2beta(npred_lm, partial = T)
